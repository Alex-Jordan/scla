<?xml version="1.0" encoding="UTF-8" ?>
<section acro="IS">
<title>Invariant Subspaces</title>

<introduction></introduction>
<subsection>
<!-- %%%%%%%%%% -->
<!-- % -->
<!-- %  Section IS -->
<!-- %  Invariant Subspaces -->
<!-- % -->
<!-- %%%%%%%%%% -->
{\sc\large This section is in draft form}\\
{\sc\large Nearly complete}
<p><p>\medskip
We have seen in <acroref type="section" acro="NLT" /> that nilpotent linear transformations are almost never diagonalizable (<acroref type="theorem" acro="DNLT" />), yet have matrix representations that are very nearly diagonal (<acroref type="theorem" acro="CFNLT" />).  Our goal in this section, and the next (<acroref type="section" acro="JCF" />), is to obtain a matrix representation of <em>any</em> linear transformation that is very nearly diagonal.  A key step in reaching this goal is an understanding of invariant subspaces, and a particular type of invariant subspace that contains vectors known as <q>generalized eigenvectors.</q>
\subsect{IS}{Invariant Subspaces}

<example acro="ISJB" index="invariant subspace!Jordan block">
<title>Invariant subspaces and Jordan blocks</title>

Refer back to <acroref type="example" acro="CFNLT" />.  We decomposed the vector space $\complex{6}
<m> into a direct sum of the subspaces </m>Z_1,\,Z_2,\,Z_3,\,Z_4<m>.  The union of the basis vectors for these subspaces is a basis of </m>\complex{6}<m>, which we reordered prior to building a matrix representation of the linear transformation </m>T$.  A principal reason for this reordering was to create invariant subspaces (though it was not obvious then).<p><p>
Define
<me><md>
<mrow>
X_1
</mrow>
<mrow>&amp;=\spn{\set{\vect{z}_{1,1},\,\vect{z}_{2,1},\,\vect{z}_{3,1},\,\vect{z}_{4,1}}}]]>
=\spn{\set{
\colvector{1\\1\\0\\1\\1\\1},\,
\colvector{1\\0\\3\\1\\0\\-1},\,
\colvector{-3\\-3\\-3\\-3\\-3\\-2},\,
\colvector{1\\0\\0\\0\\0\\0}
}}\\
X_2
</mrow>
<mrow>&amp;=\spn{\set{\vect{z}_{1,2},\,\vect{z}_{2,2}}}]]>
=\spn{\set{\colvector{-2\\-2\\-5\\-2\\-1\\0},\,\colvector{2\\1\\2\\2\\2\\1}}}
</mrow>
</md></me>
Recall from the proof of <acroref type="theorem" acro="CFNLT" /> or the computations in <acroref type="example" acro="CFNLT" /> that first elements of <m>X_1</m> and <m>X_2</m> are in the kernel of <m>T</m>, <m>\krn{T}</m>, and each element of <m>X_1</m> and <m>X_2</m> is the output of <m>T</m> when evaluated with the subsequent element of the set.  This was by design, and it is this feature of these basis vectors that leads to the nearly diagonal matrix representation with Jordan blocks.  However, we also recognize now that this property of these basis vectors allow us to conclude easily that <m>X_1</m> and <m>X_2</m> are invariant subspaces of <m>\complex{6}</m> relative to <m>T</m>.<p><p>
Furthermore, <m>\complex{6}=X_1\ds X_2</m> (<acroref type="theorem" acro="DSFB" />).  So the domain of <m>T</m> is the direct sum of invariant subspaces and the resulting matrix representation has a block diagonal form.  Hmmmmm.
</example>



\subsect{RLT}{Restrictions of Linear Transformations}
Generalized eigenspaces will prove to be an important type of invariant subspace.  



Suppose that <m>\ltdefn{T}{V}{V}</m> is a linear transformation and we can find a decomposition of <m>V</m> as a direct sum, say <m>V=U_1\ds U_2\ds U_3\ds\cdots\ds U_m</m> where each <m>U_i</m> is an invariant subspace of <m>V</m> relative to <m>T</m>.  Then, for any <m>\vect{v}\in V</m> there is a unique decomposition <m>\vect{v}=\vect{u}_1+\vect{u}_2+\vect{u}_3+\cdots+\vect{u}_m</m> with <m>\vect{u}_i\in U_i</m>, <m>1\leq i\leq m</m> and furthermore
<me><md>
<mrow>
\lt{T}{\vect{v}}
</mrow>
<mrow>&amp;=\lt{T}{\vect{u}_1+\vect{u}_2+\vect{u}_3+\cdots+\vect{u}_m}]]>
</mrow>
<mrow>&amp;&]]><acroref type="definition" acro="DS" />
</mrow>
<mrow>&amp;=\lt{T}{\vect{u}_1}+\lt{T}{\vect{u}_2}+\lt{T}{\vect{u}_3}+\cdots+\lt{T}{\vect{u}_m}]]>
</mrow>
<mrow>&amp;&]]><acroref type="theorem" acro="LTLC" />
</mrow>
<mrow>&amp;=\lt{\restrict{T}{U_1}}{\vect{u}_1}+\lt{\restrict{T}{U_2}}{\vect{u}_2}+\lt{\restrict{T}{U_3}}{\vect{u}_3}+\cdots+\lt{\restrict{T}{U_m}}{\vect{u}_m}]]>
</mrow>
</md></me>
So in a very real sense, we obtain a decomposition of the linear transformation <m>T</m> into the restrictions <m>\restrict{T}{U_i}</m>, <m>1\leq i\leq m</m>.  If we wanted to be more careful, we could extend each restriction to a linear transformation defined on <m>V</m> by setting the output of <m>\restrict{T}{U_i}</m> to be the zero vector for inputs outside of <m>U_i</m>.  Then <m>T</m> would be exactly equal to the sum (<acroref type="definition" acro="LTA" />) of these extended restrictions.  However, the irony of extending our restrictions is more than we could handle right now.<p><p>
Our real interest is in the matrix representation of a linear transformation when the domain decomposes as a direct sum of invariant subspaces.  Consider forming a basis <m>B</m> of <m>V</m> as the union of bases <m>B_i</m> from the individual <m>U_i</m>, <ie /> <m>B=\cup_{i=1}^m\,B_i</m>.  Now form the matrix representation of <m>T</m> relative to <m>B</m>.  The result will be block diagonal, where each block is the matrix representation of a restriction <m>\restrict{T}{U_i}</m> relative to a basis <m>B_i</m>, <m>\matrixrep{\restrict{T}{U_i}}{B_i}{B_i}</m>.  Though we did not have the definitions to describe it then, this is exactly what was going on in the latter portion of the proof of  <acroref type="theorem" acro="CFNLT" />.   Two examples should help to clarify these ideas.<p><p>



One last theorem will roll up much of this section and <acroref type="section" acro="NLT" /> into one nice, neat package.
<theorem acro="RGEN" index="generalized eigenspace!nilpotent restriction">
<title>Restriction to Generalized Eigenspace is Nilpotent</title>
<statement>
Suppose <m>\ltdefn{T}{V}{V}</m> is a linear transformation with eigenvalue <m>\lambda</m>.  Then the linear transformation <m>\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}</m> is nilpotent.
</statement>

<proof>
Notice first that every subspace of <m>V</m> is invariant with respect to <m>I_V</m>, so <m>I_{\geneigenspace{T}{\lambda}}=\restrict{I_V}{\geneigenspace{T}{\lambda}}</m>.    Let <m>n=\dimension{V}</m> and choose <m>\vect{v}\in\geneigenspace{T}{\lambda}</m>.  Then
<me><md>
<mrow>
\lt{\left(\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}\right)^n}{\vect{v}}
</mrow>
<mrow>&amp;=\lt{\left(T-\lambda I_V\right)^n}{\vect{v}}&amp;&amp;<acroref type="definition" acro="LTR" />
</mrow>
<mrow>&amp;=\zerovector&amp;&amp;<acroref type="theorem" acro="GEK" />
</mrow>
</md></me>
So by <acroref type="definition" acro="NLT" />, <m>\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}</m> is nilpotent.
</proof>
</theorem>

The proof of <acroref type="theorem" acro="RGEN" /> indicates that the index of the nilpotent linear transformation is less than or equal to the dimension of <m>V</m>.  In practice, it will be less than or equal to the dimension of the domain of the linear transformation, <m>\geneigenspace{T}{\lambda}</m>.  In any event, the exact value of this index will be of some interest, so we define it now.  Notice that this is a property of the eigenvalue <m>\lambda</m>, similar to the algebraic and geometric multiplicities (<acroref type="definition" acro="AME" />, <acroref type="definition" acro="GME" />).
<definition acro="IE" index="index!eigenvalue">
<title>Index of an Eigenvalue</title><p>
<indexlocation index="eigenvalue!index" />
Suppose <m>\ltdefn{T}{V}{V}</m> is a linear transformation with eigenvalue <m>\lambda</m>.  Then the <term>index</term> of <m>\lambda</m>, <m>\indx{T}{\lambda}</m>, is the index of the nilpotent linear transformation <m>\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}</m>.
<notation acro="IE" index="index!eigenvalue">
<title>Index of an Eigenvalue</title>
<usage><m>\indx{T}{\lambda}</m></usage>
</notation>
</p></definition>

<example acro="GENR6" index="generalized eigenspace!nilpotent restrictions, dimension 6 domain">
<title>Generalized eigenspaces and nilpotent restrictions, dimension 6 domain</title>

In <acroref type="example" acro="GE6" /> we computed the generalized eigenspaces of the linear transformation <m>\ltdefn{S}{\complex{6}}{\complex{6}}</m>  defined by <m>\lt{S}{\vect{x}}=B\vect{x}</m> where
<me><md>
<mrow>
\begin{bmatrix}
<![CDATA[ 2 & -4 & 25 & -54 & 90 & -37 \\]]>
<![CDATA[ 2 & -3 & 4 & -16 & 26 & -8 \\]]>
<![CDATA[ 2 & -3 & 4 & -15 & 24 & -7 \\]]>
<![CDATA[ 10 & -18 & 6 & -36 & 51 & -2 \\]]>
<![CDATA[ 8 & -14 & 0 & -21 & 28 & 4 \\]]>
<![CDATA[ 5 & -7 & -6 & -7 & 8 & 7]]>
\end{bmatrix}
</mrow>
</md></me>
The generalized eigenspace, <m>\geneigenspace{S}{3}</m>, has dimension <m>2</m>, while  <m>\geneigenspace{S}{-1}</m>, has dimension <m>4</m>.  We'll investigate each thoroughly in turn, with the intent being to illustrate <acroref type="theorem" acro="RGEN" />.  Much of our computations will be repeats of those done in <acroref type="example" acro="ISMR6" />.<p><p>
For <m>U=\geneigenspace{S}{3}</m> we compute a matrix representation of <m>\restrict{S}{U}</m> using the basis found in <acroref type="example" acro="GE6" />,
<me><md>
<mrow>
<![CDATA[B&=\set{\vect{u}_1,\,\vect{u}_2}]]>
=\set{\colvector{4\\1\\1\\2\\1\\0},\,\colvector{-5\\-1\\-1\\-1\\0\\1}}
</mrow>
</md></me>
Since <m>B</m> has size 2, we obtain a <m>2\times 2</m> matrix representation (<acroref type="definition" acro="MR" />)  from
<me><md>
<mrow>
\vectrep{B}{\lt{\restrict{S}{U}}{\vect{u}_1}}
</mrow>
<mrow>&amp;=\vectrep{B}{\colvector{11\\3\\3\\7\\4\\1}}]]>
=\vectrep{B}{4\vect{u}_1+\vect{u}_2}
=\colvector{4\\1}\\
\vectrep{B}{\lt{\restrict{S}{U}}{\vect{u}_2}}
</mrow>
<mrow>&amp;=\vectrep{B}{\colvector{-14\\-3\\-3\\-4\\-1\\2}}]]>
=\vectrep{B}{(-1)\vect{u}_1+2\vect{u}_2}
=\colvector{-1\\2}
</mrow>
</md></me>
Thus
<me><md>
<mrow>
<![CDATA[M&=\matrixrep{\restrict{S}{U}}{U}{U}]]>
=
\begin{bmatrix}
<![CDATA[4 & -1 \\]]>
<![CDATA[1 & 2]]>
\end{bmatrix}
</mrow>
</md></me>
Now we can illustrate <acroref type="theorem" acro="RGEN" /> with powers of the matrix representation (rather than the restriction itself),
<me><md>
<mrow>
<![CDATA[M-3I_2&=]]>
\begin{bmatrix}
<![CDATA[1 & -1 \\]]>
<![CDATA[1 & -1]]>
\end{bmatrix}
</mrow>
<mrow>&amp;]]>
<![CDATA[\left(M-3I_2\right)^2&=]]>
\begin{bmatrix}
<![CDATA[0 & 0 \\]]>
<![CDATA[0 & 0]]>
\end{bmatrix}
</mrow>
</md></me>
So <m>M-3I_2</m> is a nilpotent matrix of index 2 (meaning that <m>\restrict{S}{U}-3I_U</m> is a nilpotent linear transformation of index 2) and according to <acroref type="definition" acro="IE" /> we say <m>\indx{S}{3}=2</m>.<p><p>
For <m>W=\geneigenspace{S}{-1}</m> we compute a matrix representation of <m>\restrict{S}{W}</m> using the basis found in <acroref type="example" acro="GE6" />,
<me><md>
<mrow>
<![CDATA[C&=\set{\vect{w}_1,\,\vect{w}_2,\,\vect{w}_3,\,\vect{w}_4}]]>
=\set{
\colvector{5\\3\\1\\0\\0\\0},\,
\colvector{-2\\-3\\0\\1\\0\\0},\,
\colvector{4\\5\\0\\0\\1\\0},\,
\colvector{-5\\-3\\0\\0\\0\\1}
}
</mrow>
</md></me>
Since <m>C</m> has size 4, we obtain a <m>4\times 4</m> matrix representation (<acroref type="definition" acro="MR" />) from
<me><md>
<mrow>
\vectrep{C}{\lt{\restrict{S}{W}}{\vect{w}_1}}
</mrow>
<mrow>&amp;=\vectrep{C}{\colvector{23\\5\\5\\2\\-2\\-2}}]]>
=\vectrep{C}{
5\vect{w}_1+
2\vect{w}_2+
(-2)\vect{w}_3+
(-2)\vect{w}_4
}
=\colvector{5\\2\\-2\\-2}\\
\vectrep{C}{\lt{\restrict{S}{W}}{\vect{w}_2}}
</mrow>
<mrow>&amp;=\vectrep{C}{\colvector{-46\\-11\\-10\\-2\\5\\4}}]]>
=\vectrep{C}{
(-10)\vect{w}_1+
(-2)\vect{w}_2+
5\vect{w}_3+
4\vect{w}_4
}
=\colvector{-10\\-2\\5\\4}\\
\vectrep{C}{\lt{\restrict{S}{W}}{\vect{w}_3}}
</mrow>
<mrow>&amp;=\vectrep{C}{\colvector{78\\19\\17\\1\\-10\\-7}}]]>
=\vectrep{C}{
17\vect{w}_1+
\vect{w}_2+
(-10)\vect{w}_3+
(-7)\vect{w}_4
}
=\colvector{17\\1\\-10\\-7}\\
\vectrep{C}{\lt{\restrict{S}{W}}{\vect{w}_4}}
</mrow>
<mrow>&amp;=\vectrep{C}{\colvector{-35\\-9\\-8\\2\\6\\3}}]]>
=\vectrep{C}{
(-8)\vect{w}_1+
2\vect{w}_2+
6\vect{w}_3+
3\vect{w}_4
}
=\colvector{-8\\2\\6\\3}
</mrow>
</md></me>
Thus
<me><md>
<mrow>
N
</mrow>
<mrow>&amp;=\matrixrep{\restrict{S}{W}}{W}{W}]]>
=
\begin{bmatrix}
<![CDATA[ 5 & -10 & 17 & -8 \\]]>
<![CDATA[ 2 & -2 & 1 & 2 \\]]>
<![CDATA[ -2 & 5 & -10 & 6 \\]]>
<![CDATA[ -2 & 4 & -7 & 3]]>
\end{bmatrix}
</mrow>
</md></me>
Now we can illustrate <acroref type="theorem" acro="RGEN" /> with powers of the matrix representation (rather than the restriction itself),
<me><md>
<mrow>
N-(-1)I_4
</mrow>
<mrow>&amp;=]]>
\begin{bmatrix}
<![CDATA[ 6 & -10 & 17 & -8 \\]]>
<![CDATA[ 2 & -1 & 1 & 2 \\]]>
<![CDATA[ -2 & 5 & -9 & 6 \\]]>
<![CDATA[ -2 & 4 & -7 & 4]]>
\end{bmatrix}\\
\left(N-(-1)I_4\right)^2
</mrow>
<mrow>&amp;=]]>
\begin{bmatrix}
<![CDATA[ -2 & 3 & -5 & 2 \\]]>
<![CDATA[ 4 & -6 & 10 & -4 \\]]>
<![CDATA[ 4 & -6 & 10 & -4 \\]]>
<![CDATA[ 2 & -3 & 5 & -2]]>
\end{bmatrix}\\
\left(N-(-1)I_4\right)^3
</mrow>
<mrow>&amp;=]]>
\begin{bmatrix}
<![CDATA[ 0 & 0 & 0 & 0 \\]]>
<![CDATA[ 0 & 0 & 0 & 0 \\]]>
<![CDATA[ 0 & 0 & 0 & 0 \\]]>
<![CDATA[ 0 & 0 & 0 & 0]]>
\end{bmatrix}
</mrow>
</md></me>
So <m>N-(-1)I_4</m> is a nilpotent matrix of index 3 (meaning that <m>\restrict{S}{W}-(-1)I_W</m> is a nilpotent linear transformation of index 3) and according to <acroref type="definition" acro="IE" /> we say <m>\indx{S}{-1}=3</m>.<p><p>
Notice that if we were to take the union of the two bases of the generalized eigenspaces, we would have a basis for <m>\complex{6}</m>.  Then a matrix representation of <m>S</m> relative to this basis would be the same block diagonal matrix we found in <acroref type="example" acro="ISMR6" />, only we now understand each of these blocks as being very close to being a nilpotent matrix.
</example>

Invariant subspaces, and restrictions of linear transformations, are topics you will see again and again if you continue with further study of linear algebra.  Our reasons for discussing them now is to arrive at a nice matrix representation of the restriction of a linear transformation to one of its generalized eigenspaces.  Here's the theorem.
<theorem acro="MRRGE" index="matrix representation!restriction to generalized eigenspace">
<title>Matrix Representation of a Restriction to a Generalized Eigenspace</title>
<statement>
Suppose that <m>\ltdefn{T}{V}{V}</m> is a linear transformation with eigenvalue <m>\lambda</m>.  Then there is a basis of the the generalized eigenspace <m>\geneigenspace{T}{\lambda}</m> such that the restriction <m>\ltdefn{\restrict{T}{\geneigenspace{T}{\lambda}}}{\geneigenspace{T}{\lambda}}{\geneigenspace{T}{\lambda}}</m> has a matrix representation that is block diagonal where each block is a Jordan block of the form <m>\jordan{n}{\lambda}</m>.
</statement>

<proof>
<acroref type="theorem" acro="RGEN" /> tells us that <m>\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}</m> is a nilpotent linear transformation.  <acroref type="theorem" acro="CFNLT" /> tells us that a nilpotent linear transformation has a basis for its domain that yields a matrix representation that is block diagonal where the blocks are Jordan blocks of the form <m>\jordan{n}{0}</m>.  Let <m>B</m> be a basis of <m>\geneigenspace{T}{\lambda}</m> that yields such a matrix representation for <m>\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}</m>.<p><p>
By <acroref type="definition" acro="LTA" />, we can write
<me><md>
<mrow>
\restrict{T}{\geneigenspace{T}{\lambda}}
</mrow>
<mrow>&amp;=\left(]]>
\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}
\right)
+\lambda I_{\geneigenspace{T}{\lambda}}
</mrow>
</md></me>
The matrix representation of <m>\lambda I_{\geneigenspace{T}{\lambda}}</m> relative to the basis <m>B</m> is then simply the diagonal matrix <m>\lambda I_m</m>, where <m>m=\dimension{\geneigenspace{T}{\lambda}}</m>.  By <acroref type="theorem" acro="MRSLT" /> we have the rather unwieldy expression,
<me><md>
<mrow>
\matrixrep{\restrict{T}{\geneigenspace{T}{\lambda}}}{B}{B}
</mrow>
<mrow>&amp;=]]>
\matrixrep{\left(
\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}
\right)
+\lambda I_{\geneigenspace{T}{\lambda}}}{B}{B}\\
</mrow>
<mrow>&amp;=]]>
\matrixrep{
\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}
}{B}{B}
+
\matrixrep{I_{\geneigenspace{T}{\lambda}}}{B}{B}
</mrow>
</md></me>
The first of these matrix representations has Jordan blocks with zero in every diagonal entry, while the second matrix representation has <m>\lambda</m> in every diagonal entry.  The result of adding the two representations is to convert the Jordan blocks from the form <m>\jordan{n}{0}</m> to the form <m>\jordan{n}{\lambda}</m>.
</proof>
</theorem>

Of course, <acroref type="theorem" acro="CFNLT" /> provides some extra information on the sizes of the Jordan blocks in a representation and we could carry over this information to <acroref type="theorem" acro="MRRGE" />, but will save that for a subsequent application of this result.
<!--   End  IS.tex -->
</subsection>
</section>
